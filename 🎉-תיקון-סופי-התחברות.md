# π‰ ΧΧ™Χ§Χ•Χ Χ΅Χ•Χ¤Χ™ - Χ”ΧΧ—Χ‘Χ¨Χ•Χ Google ΧΆΧ•Χ‘Χ“Χ!

## ΧΧ” ΧΆΧ©Χ™Χ Χ•?

**Χ”ΧΆΧ‘Χ¨Χ Χ• ΧΧ Χ›Χ ΧΧΆΧ¨Χ›Χ Χ”Χ”ΧΧ—Χ‘Χ¨Χ•Χ Χ-Supabase Χ-Strapi!**

## Χ”Χ‘ΧΆΧ™Χ” Χ©Χ”Χ™Χ™ΧΧ”:

```
ΧΧ©ΧΧΧ© ΧΧΧ—Χ‘Χ¨ β†’ Χ™Χ•Χ¦Χ¨ Χ“Χ£ β†’ Χ©Χ’Χ™ΧΧ” 500 β
```

**ΧΧΧ”?**
- Supabase ΧΧ Χ΅Χ Χ›Χ¨Χ ΧΆΧ Χ”ΧΧΆΧ¨Χ›Χ Χ©ΧΧ Χ•
- Cookie ΧΧ Χ Χ©ΧΧ¨ Χ Χ›Χ•Χ
- userId ΧΧ Χ”Χ•ΧΆΧ‘Χ¨ ΧΧ“Χ£ Χ”Χ Χ™Χ”Χ•Χ

## Χ”Χ¤ΧΧ¨Χ•Χ:

```
ΧΧ©ΧΧΧ© ΧΧΧ—Χ‘Χ¨ β†’ Google OAuth β†’ Strapi β†’ Cookie β†’ Χ™Χ¦Χ™Χ¨Χ Χ“Χ£ β†’ Χ“Χ£ Χ Χ™Χ”Χ•Χ β…
```

**ΧΧ™Χ?**
1. Χ”Χ΅Χ¨Χ Χ• ΧΧ Supabase ΧΧ’ΧΧ¨Χ™
2. Χ”Χ•Χ΅Χ¤Χ Χ• Google OAuth Χ™Χ©Χ™Χ¨
3. Χ”ΧΧΆΧ¨Χ›Χ Χ™Χ•Χ¦Χ¨Χ ΧΧ©ΧΧΧ© Χ‘-Strapi
4. Cookie Χ Χ©ΧΧ¨ ΧΧ•ΧΧ•ΧΧΧ™Χ
5. Χ”Χ›Χ ΧΆΧ•Χ‘Χ“!

## ΧΧ” Χ”Χ©ΧΧ Χ”?

### Χ§Χ‘Χ¦Χ™Χ Χ—Χ“Χ©Χ™Χ:
1. **new-app/src/lib/stores/auth.js** - ΧΧΆΧ¨Χ›Χ Χ”ΧΧ—Χ‘Χ¨Χ•Χ Χ—Χ“Χ©Χ”
2. **new-app/src/routes/api/auth/google/+server.js** - API ΧGoogle OAuth

### Χ§Χ‘Χ¦Χ™Χ Χ©Χ”Χ©ΧΧ Χ•:
1. **new-app/.env** - Χ”Χ•Χ΅Χ¤Χ Google Client ID

### Χ§Χ‘Χ¦Χ™Χ Χ©ΧΧ Χ”Χ©ΧΧ Χ• (ΧΆΧ•Χ‘Χ“Χ™Χ ΧΧΆΧ¦ΧΧ):
1. **new-app/src/routes/login/+page.svelte** - ΧΆΧ•Χ‘Χ“ ΧΆΧ Χ”ΧΧΆΧ¨Χ›Χ Χ”Χ—Χ“Χ©Χ”
2. **new-app/src/routes/dashboard/+page.svelte** - ΧΆΧ•Χ‘Χ“ ΧΆΧ Cookie
3. **new-app/src/routes/page-creator/+page.svelte** - ΧΆΧ•Χ‘Χ“ ΧΆΧ Cookie
4. **new-app/src/routes/manage/[pageId]/+page.server.js** - ΧΆΧ•Χ‘Χ“ ΧΆΧ Cookie

## ΧΧ™Χ ΧΧ‘Χ“Χ•Χ§?

### 1. Χ”ΧΧ—Χ‘Χ¨ ΧΆΧ Google
```
http://localhost:5173/login
```
ΧΧ—Χ¥ ΧΆΧ "Χ”ΧΧ—Χ‘Χ¨ ΧΆΧ Google"

### 2. Χ‘Χ“Χ•Χ§ Χ©Χ”Χ’ΧΆΧ ΧΧ“Χ©Χ‘Χ•Χ¨Χ“
```
http://localhost:5173/dashboard
```
ΧΧΧ•Χ¨ ΧΧ¨ΧΧ•Χ ΧΧ Χ›Χ Χ”Χ“Χ¤Χ™Χ Χ©ΧΧ

### 3. Χ¦Χ•Χ¨ Χ“Χ£ Χ—Χ“Χ©
- ΧΧ—Χ¥ "Χ¦Χ•Χ¨ Χ“Χ£ Χ—Χ“Χ©"
- Χ‘Χ—Χ¨ "Χ—Χ Χ•Χ ΧΧ§Χ•Χ•Χ Χ"
- ΧΧΧ Χ¤Χ¨ΧΧ™Χ
- ΧΧ—Χ¥ "Χ¦Χ•Χ¨ Χ“Χ£"

### 4. Χ‘Χ“Χ•Χ§ Χ©Χ”Χ’ΧΆΧ ΧΧ“Χ£ Χ”Χ Χ™Χ”Χ•Χ
```
http://localhost:5173/manage/[documentId]
```
ΧΧΧ•Χ¨ ΧΧ¨ΧΧ•Χ ΧΧ Χ”Χ“Χ£ Χ©Χ™Χ¦Χ¨Χ - **Χ‘ΧΧ™ Χ©Χ’Χ™ΧΧ” 500!**

## ΧΧ” ΧΧΧ•Χ¨ ΧΧ§Χ¨Χ•Χ?

### β… Χ”ΧΧ—Χ‘Χ¨Χ•Χ:
- ΧΧ•Χ—Χ¥ "Χ”ΧΧ—Χ‘Χ¨ ΧΆΧ Google"
- Χ‘Χ•Χ—Χ¨ Χ—Χ©Χ‘Χ•Χ
- ΧΧ•ΧΆΧ‘Χ¨ ΧΧ“Χ©Χ‘Χ•Χ¨Χ“
- Χ¨Χ•ΧΧ” ΧΧ Χ”Χ©Χ Χ©ΧΧ Χ‘Χ¤Χ™Χ Χ”

### β… Χ™Χ¦Χ™Χ¨Χ Χ“Χ£:
- ΧΧ•Χ—Χ¥ "Χ¦Χ•Χ¨ Χ“Χ£ Χ—Χ“Χ©"
- Χ‘Χ•Χ—Χ¨ ΧΧ‘Χ Χ™Χ
- ΧΧΧΧ Χ¤Χ¨ΧΧ™Χ
- ΧΧ•Χ—Χ¥ "Χ¦Χ•Χ¨ Χ“Χ£"
- ΧΧ•ΧΆΧ‘Χ¨ ΧΧ“Χ£ Χ”Χ Χ™Χ”Χ•Χ
- **ΧΧ™Χ Χ©Χ’Χ™ΧΧ” 500!**

### β… Cookie:
- Χ Χ©ΧΧ¨ ΧΧ•ΧΧ•ΧΧΧ™Χ
- Χ Χ©ΧΧ¨ 30 Χ™ΧΧ™Χ
- ΧΆΧ•Χ‘Χ“ Χ‘Χ›Χ Χ”Χ“Χ¤Χ™Χ

## ΧΧ™Χ Χ–Χ” ΧΆΧ•Χ‘Χ“ ΧΧΧ—Χ•Χ¨Χ™ Χ”Χ§ΧΧΆΧ™Χ?

### ΧΧ”ΧΧ™Χ Χ”ΧΧ—Χ‘Χ¨Χ•Χ:

```javascript
// 1. ΧΧ©ΧΧΧ© ΧΧ•Χ—Χ¥ "Χ”ΧΧ—Χ‘Χ¨ ΧΆΧ Google"
signInWithGoogle(credential)

// 2. ΧΧ¤ΧΆΧ Χ— ΧΧ Χ”-JWT Χ-Google
const payload = JSON.parse(atob(credential.split('.')[1]))

// 3. Χ©Χ•ΧΧ— Χ-API Χ©ΧΧ Χ•
POST /api/auth/google
{
  googleId: "123456789",
  email: "user@gmail.com",
  name: "John Doe",
  picture: "https://..."
}

// 4. API Χ™Χ•Χ¦Χ¨ userId Χ™Χ™Χ—Χ•Χ“Χ™
const userId = `google_${googleId}`
// ΧΧ“Χ•Χ’ΧΧ”: "google_123456789"

// 5. Χ‘Χ•Χ“Χ§ ΧΧ Χ”ΧΧ©ΧΧΧ© Χ§Χ™Χ™Χ Χ‘-Strapi
const existingUser = await fetch(`${STRAPI_URL}/api/users?filters[userId][$eq]=${userId}`)

// 6. ΧΧ ΧΧ Χ§Χ™Χ™Χ - Χ™Χ•Χ¦Χ¨ Χ—Χ“Χ©
if (!existingUser) {
  await fetch(`${STRAPI_URL}/api/users`, {
    method: 'POST',
    body: JSON.stringify({
      data: {
        userId: userId,
        email: email,
        name: name,
        avatar: picture,
        subscriptionStatus: 'active' // ΧΧ©ΧΧΧ© Χ—Χ“Χ© ΧΧ§Χ‘Χ ΧΧ Χ•Χ™ Χ¤ΧΆΧ™Χ!
      }
    })
  })
}

// 7. Χ©Χ•ΧΧ¨ Cookie
cookies.set('userId', userId, {
  path: '/',
  maxAge: 60 * 60 * 24 * 30 // 30 Χ™ΧΧ™Χ
})

// 8. ΧΧ—Χ–Χ™Χ¨ ΧΧ Χ¤Χ¨ΧΧ™ Χ”ΧΧ©ΧΧΧ©
return {
  id: userId,
  userId: userId,
  email: email,
  name: name,
  avatar: picture,
  subscriptionStatus: 'active'
}

// 9. Χ”Χ“Χ¤Χ“Χ¤Χ Χ©Χ•ΧΧ¨ ΧΧ Χ”ΧΧ©ΧΧΧ© Χ‘-Store
currentUser.set(userData)

// 10. ΧΧΆΧ‘Χ™Χ¨ ΧΧ“Χ©Χ‘Χ•Χ¨Χ“
goto('/dashboard')
```

## ΧΧΧ” Χ–Χ” ΧΆΧ•Χ‘Χ“ ΧΆΧ›Χ©Χ™Χ•?

### β ΧΧ¤Χ Χ™ (Supabase):
```
Google β†’ Supabase β†’ ??? β†’ Cookie ΧΧ ΧΆΧ•Χ‘Χ“ β†’ Χ©Χ’Χ™ΧΧ” 500
```

### β… ΧΧ—Χ¨Χ™ (Strapi):
```
Google β†’ API Χ©ΧΧ Χ• β†’ Strapi β†’ Cookie ΧΆΧ•Χ‘Χ“ β†’ Χ”Χ›Χ ΧΆΧ•Χ‘Χ“!
```

## ΧΧ” Χ”Χ‘Χ“Χ™Χ§Χ•Χ?

### Χ‘Χ“Χ•Χ§ Χ‘-Console (F12):
```javascript
// Application β†’ Cookies
userId: "google_123456789" β…
```

### Χ‘Χ“Χ•Χ§ Χ‘-Terminal:
```
β… Cookie set for user: google_123456789
β… New user created: google_123456789
β… Page created successfully
π“„ Document ID: abc123xyz
π”— Redirecting to manage page: /manage/abc123xyz
```

## Χ–Χ” ΧΧΧ•Χ¨ ΧΧΆΧ‘Χ•Χ“!

Χ”ΧΧΆΧ¨Χ›Χ Χ”Χ—Χ“Χ©Χ”:
- β… Χ¤Χ©Χ•ΧΧ” Χ™Χ•ΧΧ¨
- β… ΧΧ”Χ™Χ¨Χ” Χ™Χ•ΧΧ¨
- β… ΧΧΧ™Χ Χ” Χ™Χ•ΧΧ¨
- β… Χ‘ΧΧ™ ΧΧΧ•Χ Χ—Χ™Χ¦Χ•Χ Χ™Χ
- β… Χ‘ΧΧ™ Χ©Χ’Χ™ΧΧ•Χ 500

## Χ Χ΅Χ” ΧΆΧ›Χ©Χ™Χ•!

1. Χ¤ΧΧ— `http://localhost:5173/login`
2. ΧΧ—Χ¥ "Χ”ΧΧ—Χ‘Χ¨ ΧΆΧ Google"
3. Χ¦Χ•Χ¨ Χ“Χ£ Χ—Χ“Χ©
4. ΧΧ’Χ™Χ“ ΧΧ™ ΧΧ Χ–Χ” ΧΆΧ•Χ‘Χ“! π€

---

## ΧΧ Χ–Χ” ΧΆΧ•Χ‘Χ“:
**ΧΧ’Χ™Χ“ "ΧΆΧ•Χ‘Χ“!" Χ•Χ ΧΧ©Χ™Χ ΧΧ©ΧΧ‘ Χ”Χ‘Χ** π‰

## ΧΧ Χ–Χ” ΧΧ ΧΆΧ•Χ‘Χ“:
**ΧΧΆΧΧ™Χ§ ΧΧ Χ”Χ©Χ’Χ™ΧΧ” Χ”ΧΧΧΧ” Χ•ΧΧ Χ™ ΧΧΧ§Χ** π”§

---

**Χ–Χ” ΧΧΧ•Χ¨ ΧΧΆΧ‘Χ•Χ“ ΧΆΧ›Χ©Χ™Χ•! Χ”ΧΧΆΧ¨Χ›Χ ΧΧ•Χ›Χ Χ”!** β…
