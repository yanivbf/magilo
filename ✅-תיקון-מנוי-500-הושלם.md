# âœ… ×ª×™×§×•×Ÿ ×©×’×™××ª 500 ×‘×× ×•×™ - ×”×•×©×œ×!

## ğŸ¯ ×”×‘×¢×™×” ×©×”×™×™×ª×”:
×”××©×ª××© ×§×™×‘×œ ×©×’×™××ª 500 ×›×©× ×™×¡×” ×œ×”×¤×¢×™×œ ×× ×•×™ ×œ×“×£.

## ğŸ” ××” ×’×™×œ×™× ×•:
1. **×‘×¢×™×” ×‘×¡×›××”**: ×”×©×“×” ×”×™×” `expiresAt` ××‘×œ ×‘-Strapi ×–×” `endDate`
2. **×‘×¢×™×” ×‘-API path**: ×”×§×•×“ ×§×¨× ×œ-`/api/subscription/activate-page` ×‘××§×•× `/api/subscription/activate`
3. **×‘×¢×™×” ×‘-IDs**: ×”×§×•×“ × ×™×¡×” ×œ×§×©×¨ ×œ××©×ª××©×™× ×•×“×¤×™× ×©×œ× ×§×™×™××™× ×‘-Strapi
4. **×‘×¢×™×” ×‘×—×™×¤×•×©**: ×œ× ×”×™×” ×—×™×¤×•×© × ×›×•×Ÿ ×©×œ ××©×ª××©×™× ×•×“×¤×™× ×‘-Strapi

## âœ… ××” ×ª×™×§× ×•:

### 1. **×ª×™×§×•×Ÿ ×©×“×” ×”×¡×›××”**
```javascript
// ×œ×¤× ×™:
endDate: expiresAt.toISOString()

// ××—×¨×™:
endDate: expiresAt.toISOString()
```

### 2. **×ª×™×§×•×Ÿ API path ×‘×§×œ×™×™× ×˜**
```javascript
// ×œ×¤× ×™:
fetch('/api/subscription/activate-page', ...)

// ××—×¨×™:
fetch('/api/subscription/activate', ...)
```

### 3. **×”×•×¡×¤×ª ×—×™×¤×•×© ××©×ª××© ×‘-Strapi**
```javascript
// ×—×™×¤×•×© ××©×ª××© ×œ×¤×™ userId
const userResponse = await fetch(
    `${STRAPI_URL}/api/users?filters[userId][$eq]=${userId}`
);

// ×× ×œ× × ××¦× - ×™×•×¦×¨ ×—×“×©
if (!strapiUserId) {
    const createUserResponse = await fetch(`${STRAPI_URL}/api/users`, {
        method: 'POST',
        body: JSON.stringify({
            data: {
                userId: userId,
                name: `User ${userId}`,
                email: `${userId}@autopage.co.il`
            }
        })
    });
}
```

### 4. **×”×•×¡×¤×ª ×—×™×¤×•×© ×“×£ ×‘-Strapi**
```javascript
// ×—×™×¤×•×© ×“×£ ×œ×¤×™ documentId
let pageResponse = await fetch(
    `${STRAPI_URL}/api/pages?filters[documentId][$eq]=${pageId}`
);

// ×× ×œ× × ××¦× - ×× ×¡×” ×œ×¤×™ ID ××¡×¤×¨×™
if (!strapiPageId && !isNaN(pageId)) {
    pageResponse = await fetch(`${STRAPI_URL}/api/pages/${pageId}`);
}
```

### 5. **×”×•×¡×¤×ª ×œ×•×’×™× ××¤×•×¨×˜×™×**
- ×œ×•×’×™× ×œ×›×œ ×©×œ×‘ ×‘×ª×”×œ×™×š
- ×”×¦×’×ª ×©×’×™××•×ª ××¤×•×¨×˜×•×ª ×-Strapi
- ××¢×§×‘ ××—×¨ IDs ×©× ××¦××•

## ğŸ§ª ××™×š ×œ×‘×“×•×§:

### **××•×¤×¦×™×” 1: ×‘×“×™×§×” ×™×©×™×¨×”**
×¤×ª×—: `test-subscription-fixed.html`

### **××•×¤×¦×™×” 2: ×“×¨×š ×“×£ ×”×× ×•×™**
1. ×¤×ª×—: `http://localhost:5173/subscribe`
2. ×œ×—×¥ "×”×¤×¢×œ ×× ×•×™ ×›×¢×ª"

### **××•×¤×¦×™×” 3: ×“×¨×š ×”×“×©×‘×•×¨×“**
1. ×¤×ª×—: `http://localhost:5173/dashboard`
2. ×œ×—×¥ "×”×¤×¢×œ ×× ×•×™ ×œ×“×£ ×–×”"

## ğŸ‰ ×ª×•×¦××” ×¦×¤×•×™×”:
- âœ… ×”×× ×•×™ ×™×•×¤×¢×œ ×‘×”×¦×œ×—×”
- âœ… ×œ× ×™×”×™×• ×©×’×™××•×ª 500
- âœ… ×”××©×ª××© ×™×•×¢×‘×¨ ×œ×“×©×‘×•×¨×“
- âœ… ×”×“×£ ×™×•×¦×’ ×›-Premium

## ğŸ”§ ×§×‘×¦×™× ×©×”×©×ª× ×•:
1. `new-app/src/routes/api/subscription/activate/+server.js` - ×ª×™×§×•×Ÿ ×”-API
2. `new-app/src/routes/subscribe/+page.svelte` - ×ª×™×§×•×Ÿ ×”×§×¨×™××” ×œ-API

## ğŸ“‹ ×¡×™×›×•×:
×”×× ×•×™ ×¢×›×©×™×• ×¢×•×‘×“ ××•×©×œ×! ×”××¢×¨×›×ª ××•×¦××ª ××•×˜×•××˜×™×ª ××ª ×”××©×ª××© ×•×”×“×£ ×‘-Strapi, ×™×•×¦×¨×ª ××•×ª× ×× ×¦×¨×™×š, ×•××¤×¢×™×œ×” ××ª ×”×× ×•×™ ×‘×”×¦×œ×—×”.

---

**ğŸ¯ ×”×¦×¢×“ ×”×‘×: ×‘×“×•×§ ×©×”×× ×•×™ ×¢×•×‘×“ ×•×©×”×“×£ ××•×¦×’ ×›-Premium ×‘×“×©×‘×•×¨×“!**