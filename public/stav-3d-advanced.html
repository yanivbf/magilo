<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>◊°◊™◊ô◊ï - ◊ì◊û◊ï◊™ 3D ◊û◊™◊ß◊ì◊û◊™</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1a3e 50%, #0f0f2e 100%);
            overflow: hidden;
            height: 100vh;
        }
        
        #container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            display: flex;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(102, 126, 234, 0.3);
        }
        
        button {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        #speakBtn {
            background: linear-gradient(135deg, #ec4899 0%, #f59e0b 100%);
            box-shadow: 0 10px 30px rgba(236, 72, 153, 0.4);
        }
        
        #listenBtn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        #waveBtn {
            background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }
        
        #danceBtn {
            background: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
            box-shadow: 0 10px 30px rgba(168, 85, 247, 0.4);
        }
        
        button:hover {
            transform: translateY(-3px);
        }
        
        button:active {
            transform: translateY(-1px);
        }
        
        #status {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 30px;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            color: #00ff88;
            font-size: 16px;
            border: 2px solid rgba(0, 255, 136, 0.3);
            backdrop-filter: blur(10px);
            text-align: right;
            line-height: 1.8;
        }
        
        .status-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div id="status">
        <div class="status-title">üé≠ ◊°◊™◊ô◊ï - ◊ì◊û◊ï◊™ 3D</div>
        <div id="statusText">◊ò◊ï◊¢◊ü...</div>
    </div>
    
    <div id="container"></div>
    
    <div id="controls">
        <button id="speakBtn">üó£Ô∏è ◊ì◊ë◊®</button>
        <button id="listenBtn">üëÇ ◊î◊ß◊©◊ë</button>
        <button id="waveBtn">üëã ◊†◊ï◊§◊£</button>
        <button id="danceBtn">üíÉ ◊®◊ß◊ï◊ì</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script>
        class StavAdvanced3D {
            constructor() {
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.avatar = null;
                this.clock = new THREE.Clock();
                this.particles = [];
                this.animations = {};
                
                this.state = 'listening'; // 'listening', 'speaking', 'waving', 'dancing'
                
                this.init();
            }
            
            init() {
                // Scene
                this.scene = new THREE.Scene();
                this.scene.fog = new THREE.FogExp2(0x0a0e27, 0.015);
                
                // Camera
                this.camera = new THREE.PerspectiveCamera(
                    60,
                    window.innerWidth / window.innerHeight,
                    0.1,
                    1000
                );
                this.camera.position.set(0, 1.6, 3);
                
                // Renderer
                this.renderer = new THREE.WebGLRenderer({
                    antialias: true,
                    alpha: false
                });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                document.getElementById('container').appendChild(this.renderer.domElement);
                
                // Lights
                this.setupLights();
                
                // Create Avatar
                this.createAvatar();
                
                // Particles
                this.createParticles();
                
                // Resize
                window.addEventListener('resize', () => this.onResize());
                
                // Start
                this.animate();
                
                this.updateStatus('‚úÖ ◊û◊ï◊õ◊ü!');
            }
            
            setupLights() {
                // Ambient
                const ambient = new THREE.AmbientLight(0xffffff, 0.4);
                this.scene.add(ambient);
                
                // Key light
                const keyLight = new THREE.DirectionalLight(0xffffff, 0.8);
                keyLight.position.set(2, 3, 2);
                keyLight.castShadow = true;
                this.scene.add(keyLight);
                
                // Fill light (purple)
                const fillLight = new THREE.PointLight(0x667eea, 1, 10);
                fillLight.position.set(-2, 1, 1);
                this.scene.add(fillLight);
                
                // Rim light (pink)
                const rimLight = new THREE.PointLight(0xec4899, 1, 10);
                rimLight.position.set(0, 2, -2);
                this.scene.add(rimLight);
                
                // Bottom glow
                const bottomGlow = new THREE.PointLight(0x764ba2, 0.8, 5);
                bottomGlow.position.set(0, 0, 0);
                this.scene.add(bottomGlow);
            }
            
            createAvatar() {
                this.avatar = new THREE.Group();
                
                // Body
                const bodyGeo = new THREE.CapsuleGeometry(0.3, 1.2, 16, 32);
                const bodyMat = new THREE.MeshPhongMaterial({
                    color: 0x4a5568,
                    emissive: 0x667eea,
                    emissiveIntensity: 0.3,
                    shininess: 100,
                    transparent: true,
                    opacity: 0.9
                });
                this.body = new THREE.Mesh(bodyGeo, bodyMat);
                this.body.position.y = 1.0;
                this.body.castShadow = true;
                this.avatar.add(this.body);
                
                // Head
                const headGeo = new THREE.SphereGeometry(0.28, 32, 32);
                const headMat = new THREE.MeshPhongMaterial({
                    color: 0x6366f1,
                    emissive: 0x764ba2,
                    emissiveIntensity: 0.3,
                    shininess: 100,
                    transparent: true,
                    opacity: 0.9
                });
                this.head = new THREE.Mesh(headGeo, headMat);
                this.head.position.y = 1.9;
                this.head.castShadow = true;
                this.avatar.add(this.head);
                
                // Eyes
                const eyeGeo = new THREE.SphereGeometry(0.05, 16, 16);
                const eyeMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
                
                this.leftEye = new THREE.Mesh(eyeGeo, eyeMat);
                this.leftEye.position.set(-0.1, 1.95, 0.23);
                this.avatar.add(this.leftEye);
                
                this.rightEye = new THREE.Mesh(eyeGeo, eyeMat);
                this.rightEye.position.set(0.1, 1.95, 0.23);
                this.avatar.add(this.rightEye);
                
                // Pupils
                const pupilGeo = new THREE.SphereGeometry(0.025, 16, 16);
                const pupilMat = new THREE.MeshBasicMaterial({ color: 0x667eea });
                
                this.leftPupil = new THREE.Mesh(pupilGeo, pupilMat);
                this.leftPupil.position.set(-0.1, 1.95, 0.26);
                this.avatar.add(this.leftPupil);
                
                this.rightPupil = new THREE.Mesh(pupilGeo, pupilMat);
                this.rightPupil.position.set(0.1, 1.95, 0.26);
                this.avatar.add(this.rightPupil);
                
                // Mouth (for lip sync)
                const mouthGeo = new THREE.TorusGeometry(0.1, 0.02, 16, 32, Math.PI);
                const mouthMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
                this.mouth = new THREE.Mesh(mouthGeo, mouthMat);
                this.mouth.position.set(0, 1.75, 0.25);
                this.mouth.rotation.x = Math.PI;
                this.avatar.add(this.mouth);
                
                // Arms
                const armGeo = new THREE.CapsuleGeometry(0.08, 0.6, 8, 16);
                const armMat = new THREE.MeshPhongMaterial({
                    color: 0x5a67d8,
                    emissive: 0x667eea,
                    emissiveIntensity: 0.2,
                    transparent: true,
                    opacity: 0.85
                });
                
                this.leftArm = new THREE.Mesh(armGeo, armMat);
                this.leftArm.position.set(-0.4, 1.2, 0);
                this.leftArm.rotation.z = -0.3;
                this.avatar.add(this.leftArm);
                
                this.rightArm = new THREE.Mesh(armGeo, armMat);
                this.rightArm.position.set(0.4, 1.2, 0);
                this.rightArm.rotation.z = 0.3;
                this.avatar.add(this.rightArm);
                
                // Main glow
                const glowGeo = new THREE.SphereGeometry(0.35, 32, 32);
                const glowMat = new THREE.MeshBasicMaterial({
                    color: 0x667eea,
                    transparent: true,
                    opacity: 0.2,
                    side: THREE.BackSide
                });
                this.glow = new THREE.Mesh(glowGeo, glowMat);
                this.glow.position.y = 1.9;
                this.avatar.add(this.glow);
                
                // Energy ring
                const ringGeo = new THREE.TorusGeometry(0.5, 0.02, 16, 100);
                const ringMat = new THREE.MeshBasicMaterial({
                    color: 0xec4899,
                    transparent: true,
                    opacity: 0.6
                });
                this.energyRing = new THREE.Mesh(ringGeo, ringMat);
                this.energyRing.position.y = 0.5;
                this.energyRing.rotation.x = Math.PI / 2;
                this.avatar.add(this.energyRing);
                
                this.scene.add(this.avatar);
                
                // Store materials for color changes
                this.bodyMaterial = bodyMat;
                this.headMaterial = headMat;
                this.glowMaterial = glowMat;
            }
            
            createParticles() {
                const particleGeo = new THREE.BufferGeometry();
                const particleCount = 200;
                const positions = new Float32Array(particleCount * 3);
                
                for (let i = 0; i < particleCount * 3; i += 3) {
                    positions[i] = (Math.random() - 0.5) * 10;
                    positions[i + 1] = Math.random() * 5;
                    positions[i + 2] = (Math.random() - 0.5) * 10;
                }
                
                particleGeo.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                
                const particleMat = new THREE.PointsMaterial({
                    color: 0x667eea,
                    size: 0.05,
                    transparent: true,
                    opacity: 0.6,
                    blending: THREE.AdditiveBlending
                });
                
                this.particleSystem = new THREE.Points(particleGeo, particleMat);
                this.scene.add(this.particleSystem);
            }
            
            startSpeaking() {
                this.state = 'speaking';
                this.updateStatus('üó£Ô∏è ◊û◊ì◊ë◊®◊™');
                
                // Change colors
                this.bodyMaterial.color.setHex(0x667eea);
                this.bodyMaterial.emissiveIntensity = 0.6;
                this.headMaterial.color.setHex(0xec4899);
                this.headMaterial.emissiveIntensity = 0.6;
                this.glowMaterial.opacity = 0.5;
                
                // Start lip sync animation
                this.animations.speaking = setInterval(() => {
                    if (this.state !== 'speaking') return;
                    
                    // Animate mouth
                    const scale = 0.8 + Math.random() * 0.4;
                    this.mouth.scale.set(scale, scale, 1);
                    
                    // Head bob
                    this.head.position.y = 1.9 + Math.sin(Date.now() * 0.01) * 0.04;
                    
                    // Body sway
                    this.body.rotation.z = Math.sin(Date.now() * 0.005) * 0.05;
                }, 50);
            }
            
            startListening() {
                this.state = 'listening';
                this.updateStatus('üëÇ ◊û◊ß◊©◊ô◊ë◊î');
                
                // Clear animations
                if (this.animations.speaking) {
                    clearInterval(this.animations.speaking);
                }
                if (this.animations.waving) {
                    clearInterval(this.animations.waving);
                }
                if (this.animations.dancing) {
                    clearInterval(this.animations.dancing);
                }
                
                // Reset colors
                this.bodyMaterial.color.setHex(0x4a5568);
                this.bodyMaterial.emissiveIntensity = 0.3;
                this.headMaterial.color.setHex(0x6366f1);
                this.headMaterial.emissiveIntensity = 0.3;
                this.glowMaterial.opacity = 0.2;
                
                // Reset positions
                this.mouth.scale.set(1, 1, 1);
                this.head.position.y = 1.9;
                this.body.rotation.z = 0;
                this.leftArm.rotation.z = -0.3;
                this.rightArm.rotation.z = 0.3;
            }
            
            startWaving() {
                this.state = 'waving';
                this.updateStatus('üëã ◊û◊†◊ï◊§◊§◊™');
                
                this.bodyMaterial.color.setHex(0x06b6d4);
                this.headMaterial.color.setHex(0x3b82f6);
                
                this.animations.waving = setInterval(() => {
                    if (this.state !== 'waving') return;
                    
                    const angle = Math.sin(Date.now() * 0.01) * 0.8;
                    this.rightArm.rotation.z = 0.3 - angle;
                    this.rightArm.rotation.x = Math.sin(Date.now() * 0.01) * 0.3;
                }, 16);
                
                setTimeout(() => {
                    if (this.state === 'waving') this.startListening();
                }, 3000);
            }
            
            startDancing() {
                this.state = 'dancing';
                this.updateStatus('üíÉ ◊®◊ï◊ß◊ì◊™');
                
                this.bodyMaterial.color.setHex(0xa855f7);
                this.headMaterial.color.setHex(0xec4899);
                this.glowMaterial.opacity = 0.6;
                
                this.animations.dancing = setInterval(() => {
                    if (this.state !== 'dancing') return;
                    
                    const time = Date.now() * 0.005;
                    
                    // Body dance
                    this.body.rotation.z = Math.sin(time) * 0.2;
                    this.body.position.y = 1.0 + Math.abs(Math.sin(time * 2)) * 0.1;
                    
                    // Head movement
                    this.head.rotation.z = Math.sin(time * 1.5) * 0.1;
                    this.head.position.y = 1.9 + Math.sin(time * 3) * 0.05;
                    
                    // Arms
                    this.leftArm.rotation.z = -0.3 + Math.sin(time * 2) * 0.5;
                    this.rightArm.rotation.z = 0.3 - Math.sin(time * 2) * 0.5;
                    
                    // Energy ring
                    this.energyRing.rotation.z = time * 2;
                }, 16);
                
                setTimeout(() => {
                    if (this.state === 'dancing') this.startListening();
                }, 5000);
            }
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                const delta = this.clock.getDelta();
                const time = this.clock.getElapsedTime();
                
                // Float animation (always active)
                if (this.avatar && this.state !== 'dancing') {
                    this.avatar.position.y = Math.sin(time * 1.5) * 0.08;
                    if (this.state === 'listening') {
                        this.avatar.rotation.y = Math.sin(time * 0.5) * 0.1;
                    }
                }
                
                // Energy ring rotation
                if (this.energyRing && this.state !== 'dancing') {
                    this.energyRing.rotation.z += delta * 0.5;
                }
                
                // Glow pulse
                if (this.glow) {
                    this.glow.scale.set(
                        1 + Math.sin(time * 2) * 0.05,
                        1 + Math.sin(time * 2) * 0.05,
                        1 + Math.sin(time * 2) * 0.05
                    );
                }
                
                // Particles
                if (this.particleSystem) {
                    this.particleSystem.rotation.y += delta * 0.1;
                }
                
                // Eye blink
                if (Math.random() < 0.01) {
                    this.leftEye.scale.y = 0.1;
                    this.rightEye.scale.y = 0.1;
                    setTimeout(() => {
                        this.leftEye.scale.y = 1;
                        this.rightEye.scale.y = 1;
                    }, 100);
                }
                
                this.renderer.render(this.scene, this.camera);
            }
            
            onResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
            }
            
            updateStatus(text) {
                document.getElementById('statusText').textContent = text;
            }
        }
        
        // Initialize
        let stav = null;
        window.addEventListener('load', () => {
            stav = new StavAdvanced3D();
            
            // Controls
            document.getElementById('speakBtn').addEventListener('click', () => {
                stav.startSpeaking();
                setTimeout(() => stav.startListening(), 3000);
            });
            
            document.getElementById('listenBtn').addEventListener('click', () => {
                stav.startListening();
            });
            
            document.getElementById('waveBtn').addEventListener('click', () => {
                stav.startWaving();
            });
            
            document.getElementById('danceBtn').addEventListener('click', () => {
                stav.startDancing();
            });
        });
    </script>
</body>
</html>









